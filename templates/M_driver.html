<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/general.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/driver.css') }}">
</head>

<body>
    <div class="logo">
        <img src="{{ url_for('static', filename='assets/logo.png') }}">
    </div>
    <div class="container">
        <div id="orders" class="title-and-orders">
            <h2>Current orders:</h2>
            {% for m in order_list %}
            <div class="order" data-id="{{ m }}" onclick="selectOrder(this)">
                <p>{{ [m['last_point'], m['starting_point']] + m['additional'] if m['additional'] else [m['last_point'],
                    m['starting_point']]}}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="buttons">
        <form action='/driver_page' method="post">
            <button id="sendButton" type='submit' class="button">Accept the chosen order</button>
        </form>
        <button class="button" onclick="window.location.href='Map.html'">See on a map</button>
    </div>
    <div>
        <img class="profile" onclick="window.location.href='/profile'"
            src="{{ url_for('static', filename='assets/transperent_person.png') }}">
    </div>

    <script>
        function selectOrder(element) {
            document.querySelectorAll('.order').forEach(order => {
                order.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        document.getElementById('sendButton').addEventListener('click', function (event) {
            event.preventDefault();

            const selectedOrder = document.querySelector('.order.selected');
            if (selectedOrder) {
                const orderId = selectedOrder.getAttribute('data-id');
                const formData = new FormData();
                formData.append('orderId', orderId);

                fetch('/driver_page', {
                    method: 'POST',
                    body: formData
                }).then(response => response.json())
                    .then(data => {
                        console.log('Дані успішно відправлено:', data);
                    }).catch(error => {
                        console.error('Помилка під час відправлення запиту:', error);
                    });
            } else {
                console.log('Спочатку виберіть замовлення');
            }
        });

    </script>


</body>

</html>